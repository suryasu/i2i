YUI.add("hermes-template-photo-well-ad",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'<a class="ad-frame" href="'+e.escapeExpression((s=(s=n.clickUrl||(t!=null?t.clickUrl:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"clickUrl",hash:{},data:i}):s))+'" data-track="ad_link_image" target="_blank">'},3:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'    <div class="ad-wrapper">\n        <img width=\''+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"' height='"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+"' src='"+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'\'/>\n        <a class="ad-footer" href="'+f((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.clickUrl:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'" data-track="ad_link_bottom" target="_blank">\n            <h1>'+f((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{brand:t!=null?t.brand:t,intlName:"photo-page-scrappy.FIND_OUT_MORE_AD"},data:i}))+"</h1>\n        </a>\n    </div>\n"},5:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return"    <img width='"+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"' height='"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+"' src='"+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+"' />\n"},7:function(e,t,n,r,i){return'<div class="more-info"> \n\n	<span><i class="moneyball"></i> '+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{brand:t!=null?t.brand:t,intlName:"photo-page-scrappy.FIND_OUT_MORE_AD"},data:i}))+"</span>\n</div>\n</a>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u,a=t!=null?t:{},f=n.helperMissing,l="function",c=n.blockHelperMissing,h=((s=n["if"].call(a,t!=null?t.adFrame:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n\n";return s=(o=(o=n.adsTypeB||(t!=null?t.adsTypeB:t))!=null?o:f,u={name:"adsTypeB",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i},typeof o===l?o.call(a,u):o),n.adsTypeB||(s=c.call(t,s,u)),s!=null&&(h+=s),s=(o=(o=n.adsTypeB||(t!=null?t.adsTypeB:t))!=null?o:f,u={name:"adsTypeB",hash:{},fn:e.noop,inverse:e.program(5,i,0),data:i},typeof o===l?o.call(a,u):o),n.adsTypeB||(s=c.call(t,s,u)),s!=null&&(h+=s),h+"\n"+((s=n["if"].call(a,t!=null?t.adFrame:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-ad",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-well-media-scrappy-view",function(e,t){var n=require("lib/flog")(t),r=500,i=500,s=40,o;o={photo:{render:function(){var t=this,n=this.get("photo"),r,i,s,o="";return t.preloadImage&&(t.preloadImage.onload=null),this.appContext.forceServerRender?(r=this.getPhotoForDisplay({canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}),i=r):(r=this.getPhotoForDisplay(),i=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]})),n.getValue("owner")&&(n.getValue("title").trim()===""?o=this.intlMessage({intlName:"common.UNTITLED"}):o=n.getValue("title"),o+=" | "+this.intlMessage({intlName:"common.BY_USER",user:n.getValue("owner").getValue("username")})),s=this.get("container").one(".main-photo"),(!s||parseInt(s.getAttribute("width"),10)!==r.width||parseInt(s.getAttribute("height"),10)!==r.height)&&this.setContainerWithTemplate("photo-well-media-scrappy",{width:r.width,height:r.height,src:i.url,highResSrc:r.url,imgAltText:o,needsInterstitial:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor}),YUI.Env.isServer?(this.serverWidth=r.width,this.serverHeight=r.height):n.getValue("needsInterstitial")||(t.preloadImage=new Image,t.preloadImage.onload=function(){if(this.onloadFired)return;if(!t.isActiveAndInDOM())return;this.onloadFired=!0;var n,i="photoPageShowedSize",s="\u00f8";try{n=/(?:_([a-z]))?\.jpg/.exec(r.url),n&&n[1]&&(s=n[1])}catch(o){}finally{i+=String(s).toUpperCase()}e.rapidTracker.beacon(this.name,i);var u=t.get("container").one(".low-res-photo"),a=t.get("container").one(".main-photo");a.removeClass("is-hidden").show(),u.hide()},t.preloadImage.src=r.url,t.preloadImage.complete&&t.preloadImage.onload()),this}},video:{render:function(){var e=this.get("photo"),t=this.appContext.flipper.isFlipped("enable-html5-video-2016"),n=this.getPhotoForDisplay({excludeSizes:[]});return this.player?(this.player.dimension&&t?(this.player.dimension("width",n.width),this.player.dimension("height",n.height)):this.player.resize(n.width,n.height),this):(this.setContainerWithTemplate("photo-well-media-scrappy",{width:n.width,height:n.height,src:n.url,needsInterstitial:e.getValue("needsInterstitial"),isVideo:!0,isHTML5Video:t,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":""}),this)}},ad:{render:function(){var e,t;return this.adJSON?e=this.adJSON:(e=this.appContext.adManager.getAdJSON(),this.adJSON=e),t=this.getAdSize(e),this.setContainerWithTemplate("photo-well-ad",{width:t.width,height:t.height,src:e.url,clickUrl:e.clickUrl,brand:e.brand,adsTypeB:this.appContext.flipper.isFlipped("moneyball-ads-type-b"),adFrame:!0}),this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("enable-scrappy-zoom")}},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?o.ad.render.call(this):o[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&this.subviews["zoom-view"]&&(this.canVR=!0,this.subviews["zoom-view"].destroy({remove:!0})),this},handleInterstitialDismissButtonClick:function(t){var r=this,i=this.get("personPreferences"),s=this.get("photo"),o=s.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),i.setValue("safeSearch",o),i.registry.remoteUpdate(r.appContext.auth.user.nsid).then(function(e){var t=s.registry.attributeSearch({needsInterstitial:!0});t.forEach(function(e){s.registry.getValue(e,"safetyLevel")<=i.getValue("safeSearch")&&s.registry.setValue(e,"needsInterstitial",!1)}),r.buildContainer()},function(e){n.error({err:e}),r.onError(r.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))})},onParentViewEvent:function(e,t){t&&t[0]==="photoWellResized"&&(this.get("photo").getValue("needsInterstitial")||(this.set("canvasSizeIsDirty",!0),this.buildContainer()))},activate:function(){var t=this,n,r;return this.get("photo").getValue("isVideo")&&(t.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1")._node:null}),t.player.init().then(function(){}),t.on("destroy",function(){t.player&&(t.player.destroy(),t.player=null)})),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),this.registerEventHandler(e.on("flickr:display-note-box",function(i){n=e.Node.create('<div class="note-box"></div>'),r=t.get("container").one(".main-photo").getXY(),t.get("container").append(n),n.setStyles({top:i.noteBoxTop+t.get("container").one(".main-photo").getDOMNode().offsetTop,left:i.noteBoxLeft,width:i.noteBoxWidth,height:i.noteBoxHeight})})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},onError:function(t){var n=this;this.fire("subviewViewEvent","getDialogOffset",function(r){var i=e.Views.dialog.getInstance
("dialog-alert",{content:t,attrs:{title:"Error",level:"warning",confirmLabel:"OK"},parent:n,offsetLeft:r,dialogClass:"scrappy-dialog"});i.show()})},getPhotoForDisplay:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r,i,s;return e&&e.canvasSize&&(t=e.canvasSize),r=this.get("photo").getSizeToFit(t,e),i=Math.min(t.height/n,r.height),s=Math.min(t.width/n,r.width/r.height*i),i=Math.min(i,r.height/r.width*s),{width:Math.round(s),height:Math.round(i),url:r.url,pixelRatio:r.width/s}},getAdSize:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=80,i=140,s,o;return this.appContext.flipper.isFlipped("moneyball-ads-type-b")&&(t.height-=(r+i)*n,t.width-=i*n),s=Math.min(t.height/n,e.height),o=Math.min(t.width/n,e.width/e.height*s),s=Math.min(s,e.height/e.width*o),{width:o,height:s}},getCanvasSize:function(){var e,t=this.getPixelRatio(),n,o=this.get("container"),u,a,f,l,c={width:r,height:i};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(n=this.get("container").ancestor(),u=o.getStyle("paddingTop")?parseInt(o.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,a=o.getStyle("paddingBottom")?parseInt(o.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,l=s,f=s,n&&(e=n.get("region"),e.height=parseInt(n.getStyle("height").match(/[0-9]+/)[0],10)-(u+a),e.width=this.appContext.viewportData.viewport.width-(l+f))):e=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(c={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),e||(e={top:0,left:0,bottom:i,right:r,width:c.width,height:c.height}),e.height*=t,e.width*=t,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flickr-view","moment","flickr-video-player","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy","hermes-template-photo-well-ad"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-context-slider-photo",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return"currentImage"},3:function(e,t,n,r,i){return"restricted-image"},5:function(e,t,n,r,i){return"		<span class='play-slideshow'>&#9654;</span>\n		<span class='countdown-slideshow'></span>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<a class="context-thumb emptyImage '+((s=n["if"].call(u,t!=null?t.currentPhoto:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n["if"].call(u,t!=null?t.needsInterstitial:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'" href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" data-track="contextSliderNextPhotoClick" style="background-image: url('+l((o=(o=n.background||(t!=null?t.background:t))!=null?o:a,typeof o===f?o.call(u,{name:"background",hash:{},data:i}):o))+"); left: "+l((o=(o=n.left||(t!=null?t.left:t))!=null?o:a,typeof o===f?o.call(u,{name:"left",hash:{},data:i}):o))+'px" data-photo-id="'+l((o=(o=n.id||(t!=null?t.id:t))!=null?o:a,typeof o===f?o.call(u,{name:"id",hash:{},data:i}):o))+'" title="'+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+'">\n'+((s=n["if"].call(u,t!=null?t.currentPhoto:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+"</a>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-slider-photo",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-context-slider-scrappy",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"	<div class='loadingError'>\n		<p>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ERROR_LOADING_CONTEXT"},data:i}))+'</p>\n		<p><button href="#" class="ui-button ui-button-cta ui-button-transparent retry">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:i}))+"</button></p>\n	</div>\n"},3:function(e,t,n,r,i){var s,o=t!=null?t:{};return"\n	<div class='context-slider small-slider "+((s=n["if"].call(o,t!=null?t.slideshowEnabled:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\'>\n\n		<div class="wrapper is-ready clear-float small-photos">\n\n			<div class="slider">\n\n'+((s=n.each.call(o,t!=null?t.previousPhotos:t,{name:"each",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t["is-ad"]:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i}))!=null?s:"")+"\n\n"+((s=n.each.call(o,t!=null?t.nextPhotos:t,{name:"each",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n			</div>\n\n		</div>\n\n	</div>\n\n"+((s=n["if"].call(o,t!=null?t.showBigSlider:t,{name:"if",hash:{},fn:e.program(13,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},4:function(e,t,n,r,i){return"slideshowEnabled"},6:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"					",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},8:function(e,t,n,r,i){return'					<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},10:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.currentPhoto:t,{name:"each",hash:{},fn:e.program(11,i,0),inverse:e.noop,data:i}))!=null?s:""},11:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"						",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},13:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"		<div class='context-slider big-slider "+((s=n["if"].call(o,t!=null?t.slideshowEnabled:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\'>\n\n			<span class="nav nav-l">\n				<span class="hide-text">&larr;</span>\n			</span>\n\n			<div class="wrapper clear-float">\n\n				<div class="slider">\n\n					'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.previousBigPhotos:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"\n\n"+((s=n["if"].call(o,t!=null?t["is-ad"]:t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.program(16,i,0),data:i}))!=null?s:"")+"\n					"+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.nextBigPhotos:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n\n				</div>\n\n			</div>\n\n			<span class="nav nav-r">\n				<span class="hide-text">&rarr;</span>\n			</span>\n\n		</div>\n'},14:function(e,t,n,r,i){return'						<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},16:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.currentPhoto:t,{name:"each",hash:{},fn:e.program(17,i,0),inverse:e.noop,data:i}))!=null?s:""},17:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"							",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.loadingError:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:""},usePartial:!0,useData:!0}),r={};e.Array.each(["context-slider-photo","context-slider-photo","context-slider-photo","context-slider-photo"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-slider-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo"]});
YUI.add("hermes-template-context-image",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'\n	<a data-loaded="false" style="left:'+e.escapeExpression((s=(s=n.left||(t!=null?t.left:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"left",hash:{},data:i}):s))+';float:left;display:block;position:absolute;background-color:gray;height:40px;width:86px;border:1px solid transparent;" href="#">\n		\n	</a>\n\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.images:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-image",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-context-text",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'\n\n<span data-loaded="true" style="left:'+f((s=(s=n.left||(t!=null?t.left:t))!=null?s:u,typeof s===a?s.call(o,{name:"left",hash:{},data:i}):s))+';float:left;display:block;position:absolute;height:40px;width:86px;border:1px solid #ccc;" href="#">\n	'+f((s=(s=n.text||(t!=null?t.text:t))!=null?s:u,typeof s===a?s.call(o,{name:"text",hash:{},data:i}):s))+"\n</span>\n\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-text",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("context-slider-scrappy-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.currentPosition=0,this.numberOfPhotosEitherSideInViewPort=3,this.numberOfPositionsToMove=3,this.numberOfPositionsToBuffer=3,this.positionsLoadedNext=0,this.positionsLoadedPrev=0,this.positionsAheadLimit=25,this.numberOfPositionsToPreFetch=t.numberOfPositionsToPreFetch,this.numberOfPositionsToRefetchAt=t.numberOfPositionsToRefetchAt,this.photoWidth=50,this.photoMargin=15,this.photoWidthPlusMargin=65,this.photoWidthSmall=20,this.photoMarginSmall=5,this.photoWidthPlusMarginSmall=25,this.atStart=!1,this.atEnd=!1,this.isAd=!!t.ad,this.photosInSlider={},!YUI.Env.isServer&&e.StorageHelper.getItem("slideshowInProgress")==="true"?this.slideshowInProgress=!0:this.slideshowInProgress=!1,this.slideshowDwellSeconds=5,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this,r=t.contextData,i=new e.FlickrPromise({photo:t.appContext.getModel("photo-models",t.photoId),context:t.appContext.getModel(r.modelName,r.params)});return i.then(function(e){t.set("photo",e.photo),t.set("contextModel",e.context)},function(e){if(!e.getModelFailure&&e.code!==1||r.modelName==="photostream-models")throw e;return t.contextData.modelName="photostream-models",t.appContext.getModel("photo-models",t.photoId).then(function(e){return t.set("photo",e),t.contextData.params.id=t.get("photo").getValue("owner").getValue("nsid"),t.appContext.getModel("photostream-models",t.contextData.params).then(function(e){t.set("contextModel",e)})})}).then(function(){var n=e.merge(r.params,{photoId:t.photoId,numNext:t.numberOfPositionsToPreFetch,numPrev:t.numberOfPositionsToPreFetch,refetchAt:t.numberOfPositionsToRefetchAt});return t.get("contextModel").getValue("photoContextList").getContext(n)}).then(function(e){t.positionsLoadedNext=t.positionsLoadedNext+e.next.length,t.positionsLoadedPrev=t.positionsLoadedPrev+e.previous.length,t.photosInSlider[0]=t.get("photo").getValue("id"),t.set("initialContextResponse",e)},function(e){if(e.notInContext||e.code===99)return t.get("contextModel").setValue("photoContextList",[]),t.contextData.modelName="photostream-models",t.contextData.params.id=t.get("photo").getValue("owner").getValue("nsid"),t.loadState();throw e}).then(null,function(e){throw n.error("There was a problem loading the context slider data.",{err:e}),e})},assignContextPositionsAndAddToDOM:function(e){var t=this.get("container"),n=t.one(".small-slider .slider"),r=t.one(".big-slider .slider"),i=e.contextResponse,s,o,u;for(u=0;u<i.previous.length;u++)o=-1-u,typeof this.photosInSlider[o]=="undefined"&&(s=i.previous[u].toJSON(),this.photosInSlider[o]=i.previous[u].getValue("id"),s.left=o*this.photoWidthPlusMarginSmall,s.background=this.getBackgroundImage(i.previous[u]),s.url=this.getContextifiedURLForPhoto(i.previous[u]),n.append(this.templates("context-slider-photo")(s)),s.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(s)));for(u=0;u<i.next.length;u++)o=1+u,typeof this.photosInSlider[o]=="undefined"&&(s=i.next[u].toJSON(),this.photosInSlider[o]=i.next[u].getValue("id"),s.left=o*this.photoWidthPlusMarginSmall,s.background=this.getBackgroundImage(i.next[u]),s.url=this.getContextifiedURLForPhoto(i.next[u]),n.append(this.templates("context-slider-photo")(s)),s.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(s)))},checkBoundary:function(e){var t=e.contextResponse,n=e.requestedPreviousAmount,r=e.requestedNextAmount,i=e.positionWhenChecking,s=this.get("contextModel").getValue("photoContextList"),o=this.get("container"),u=o.one(".nav-l"),a=o.one(".nav-r");this.currentPosition-this.numberOfPhotosEitherSideInViewPort>this.positionsLoadedNext&&this.move(-Math.abs(this.currentPosition-this.positionsLoadedNext)),this.currentPosition<0&&Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)>this.positionsLoadedPrev&&this.move(Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)-this.positionsLoadedPrev),s.hasMinBoundary()&&t.previous.length-Math.abs(i)<=this.numberOfPhotosEitherSideInViewPort&&n>0&&(u.hide(),this.atStart=!0),s.hasMaxBoundary()&&t.next.length-Math.abs(i)<=this.numberOfPhotosEitherSideInViewPort&&r>0&&(a.hide(),this.atEnd=!0)},buildContainer:function(){function u(e,r,i,s){e>3&&(e=3);var o=t[r],u="";for(var a=0;a<e;a++){var f=o[a],l=f.toJSON(),c=(a+1)*n.photoWidthPlusMarginSmall*s;l.background=n.getBackgroundImage(f),l.currentPhoto=!1,l.url=n.getContextifiedURLForPhoto(f),l.left=c/n.photoWidthPlusMarginSmall*n.photoWidthPlusMargin,u+=n.templates("context-slider-photo")(l),l.left=c,i.push(l),n.photosInSlider[""+(a+1)*s]=l}return u}var e=this.get("photo").toJSON(),t=this.get("initialContextResponse"),n=this;e.background=this.getBackgroundImage(this.get("photo")),e.left=0,e.currentPhoto=!0,e.url=this.getContextifiedURLForPhoto(this.get("photo"));var r=[],i=[],s="",o="";this.positionsLoadedNext>0&&(o=u(this.positionsLoadedNext,"next",r,1)),this.positionsLoadedPrev>0&&(s=u(this.positionsLoadedPrev,"previous",i,-1)),this.setContainerWithTemplate("context-slider-scrappy",{previousPhotos:i,nextPhotos:r,previousBigPhotos:s,nextBigPhotos:o,currentPhoto:[e],slideshowEnabled:this.appContext.flipper.isFlipped("enable-photopage-slideshow"),"is-ad":this.isAd,showBigSlider:!this.appContext.forceServerRender}),this.isAd&&(t.next.pop(),t.next=[this.get("photo")].concat(t.next))},buildErrorContainer:function(){this.setContainerWithTemplate("context-slider-scrappy",{loadingError:!0})},activate:function(){var t=this,n=t.get("container"),r=n.one(".big-slider"),i=!1,s,o,u=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,a=this.numberOfPhotosEitherSideInViewPort;return this.assignContextPositionsAndAddToDOM({contextResponse:this.get("initialContextResponse"
),requestedPreviousAmount:a,requestedNextAmount:a}),this.checkBoundary({contextResponse:this.get("initialContextResponse"),requestedPreviousAmount:a,requestedNextAmount:a,positionWhenChecking:this.currentPosition}),e.StorageHelper.getItem("showBigContextSlider")==="true"?(n.addClass("hover"),setTimeout(function(){n.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),n.all(".context-slider").setStyle("transition","opacity 300ms ease-out")},300)):(n.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),n.all(".context-slider").setStyle("transition","opacity 300ms ease-out")),this.appContext.flipper.isFlipped("enable-photopage-slideshow")&&(this.slideshowInProgress&&this.startSlideshow(),this.registerEventHandler(this.get("container").all(".currentImage").on("click",function(e){e.preventDefault(),t.slideshowInProgress?t.stopSlideshow():t.startSlideshow()}))),e.use("transition",function(e){var a=t.get("container").one(".nav-l"),f=t.get("container").one(".nav-r");a&&t.registerEventHandler(a.on("click",function(){n.setStyle("transition","opacity 300ms ease-out"),e.rapidTracker.beacon(t.name,"contextSliderMoveLeftClick"),t.move(-1*t.numberOfPositionsToMove)})),f&&t.registerEventHandler(f.on("click",function(){n.setStyle("transition","opacity 300ms ease-out"),e.rapidTracker.beacon(t.name,"contextSliderMoveRightClick"),t.move(1*t.numberOfPositionsToMove)})),u&&(t.attachKeyEvent("down:188",e.betterThrottle(function(r){e.rapidTracker.beacon(t.name,"contextSliderMoveLeftKeyPress"),n.addClass("hover"),t.bringIntoFocus(),t.atStart||t.move(-1*t.numberOfPositionsToMove)},20)),t.attachKeyEvent("down:190",e.betterThrottle(function(r){e.rapidTracker.beacon(t.name,"contextSliderMoveRightKeyPress"),n.addClass("hover"),t.bringIntoFocus(),t.atEnd||t.move(1*t.numberOfPositionsToMove)},20))),t.registerEventHandler(n.on("hover",function(){i=!0,clearTimeout(s),s=setTimeout(function(){i&&n.addClass("hover")},150)},function(){i=!1,clearTimeout(o),e.StorageHelper.setItem("showBigContextSlider","false"),o=setTimeout(function(){i||(n.setStyles({width:"100%",height:"80px"}),r.setStyle("height","80px"),n.removeClass("hover"),setTimeout(function(){n.removeAttribute("style"),r.removeAttribute("style")},300))},500)})),t.registerEventHandler(n.all(".context-thumb:not(.currentImage)").on("click",function(){e.StorageHelper.setItem("showBigContextSlider","true")}))}),this},startSlideshow:function(){function s(){if(r===0&&t.slideshowInProgress){t.appContext.flapp.navigate(n);return}i.all(".currentImage .countdown-slideshow").set("text",r),r-=1}this.slideshowInProgress=!0;var t=this,n=this.getContextifiedURLForPhoto(this.get("initialContextResponse").next[0]),r=this.slideshowDwellSeconds,i=this.get("container");e.StorageHelper.setItem("slideshowInProgress","true"),i.all(".currentImage .play-slideshow").hide(),s(),this.slideshowTimer=setInterval(function(){s()},1e3)},stopSlideshow:function(){this.slideshowInProgress=!1,this.get("container").all(".currentImage .countdown-slideshow").set("text",""),this.get("container").all(".currentImage .play-slideshow").show(),clearInterval(this.slideshowTimer),e.StorageHelper.setItem("slideshowInProgress","false")},move:function(t){var n=this,r=this.get("contextModel").getValue("photoContextList"),i=t>0?"right":"left",s=this.get("container"),o=s.one(".big-slider .slider"),u=s.one(".small-slider .slider"),a,f,l,c,h,p=s.one(".nav-l"),d=s.one(".nav-r"),v;if(i==="right"&&this.currentPosition-this.positionsLoadedNext>this.positionsAheadLimit)return!1;if(i==="left"&&this.currentPosition<=0&&Math.abs(this.currentPosition)-this.positionsLoadedPrev>this.positionsAheadLimit)return!1;s.addClass("hover"),this.currentPosition+=t,v=this.currentPosition,typeof this.photosInSlider[this.currentPosition+this.numberOfPhotosEitherSideInViewPort+1]!="undefined"&&(d.show(),this.atEnd=!1),typeof this.photosInSlider[this.currentPosition-(this.numberOfPhotosEitherSideInViewPort+1)]!="undefined"&&(p.show(),this.atStart=!1),a=this.currentPosition*this.photoWidthPlusMargin*-1,f=this.currentPosition*this.photoWidthPlusMarginSmall*-1,o.transition({left:a+"px",duration:.3,easing:"ease-out"}),u.setStyle("left",f+"px"),i==="right"?c=this.currentPosition+this.numberOfPositionsToMove+this.numberOfPositionsToBuffer:i==="left"&&(c=this.currentPosition-(this.numberOfPositionsToMove+this.numberOfPositionsToBuffer)),l=typeof this.photosInSlider[c]=="undefined",l&&(h=e.merge(n.contextData.params,{photoId:this.get("photo").getValue("id"),refetchAt:this.numberOfPositionsToRefetchAt}),i==="right"?h.numNext=Math.abs(c)+this.numberOfPositionsToPreFetch:i==="left"&&(h.numPrev=Math.abs(c)+this.numberOfPositionsToPreFetch),r.getContext(h).then(function(e){n.positionsLoadedNext=typeof h.numNext!="undefined"?h.numNext:n.positionsLoadedNext,n.positionsLoadedPrev=typeof h.numPrev!="undefined"?h.numPrev:n.positionsLoadedPrev,n.assignContextPositionsAndAddToDOM({contextResponse:e,requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext}),n.checkBoundary({contextResponse:e,requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext,positionWhenChecking:v})},function(e){n.checkBoundary({contextResponse:{previous:[],next:[]},requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext,positionWhenChecking:v})}))},getBackgroundImage:function(e){var t,n=this.appContext.getViewer().getPixelRatio(),r;return t={width:this.photoWidth*n,height:this.photoWidth*n},r={cropToFit:!0,includeSizes:["sq","t","q","s","n"]},e.getSizeToFit(t,r).url},getContextifiedURLForPhoto:function(t){if(t){var n=e.URLHelper.getPhotoPage({photoId:t.getValue("id"),pathAlias:t.getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextModel").getValue("urlSuffix")});return n}},beforeDestroy:function(){clearInterval(this.slideshowTimer)}})},"@VERSION@",{requires:["flickr-view","hermes-template-context-slider-scrappy","hermes-template-context-slider-photo","hermes-template-context-image","hermes-template-context-text"
,"context-slider-scrappy-css","storage-helper"],optional:[],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-photo-engagement",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'	<div class="button butt">\n		<a href="'+f((s=(s=n.marketplaceLicensingUrl||(t!=null?t.marketplaceLicensingUrl:t))!=null?s:u,typeof s===a?s.call(o,{name:"marketplaceLicensingUrl",hash:{},data:i}):s))+'" target="_blank" data-photoid="'+f((s=(s=n.photoId||(t!=null?t.photoId:t))!=null?s:u,typeof s===a?s.call(o,{name:"photoId",hash:{},data:i}):s))+'" data-ownerid="'+f((s=(s=n.ownerId||(t!=null?t.ownerId:t))!=null?s:u,typeof s===a?s.call(o,{name:"ownerId",hash:{},data:i}):s))+'" class="photoListLicenseButton" data-track="subPhotoLicenseButtonClick" title="'+f((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.BUY"},data:i}))+'">'+f((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.BUY"},data:i}))+"\n		</a>\n	</div>\n"},3:function(e,t,n,r,i){var s,o=t!=null?t:{};return'\n	<div class="wallart'+((s=n["if"].call(o,t!=null?t.isWallartLowQuality:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n		<a href="#" title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.CREATE_WALLART_WITH_PHOTO"},data:i}))+'">\n			<i class="ui-icon-wallart"></i>\n		</a>\n	</div>\n\n'},4:function(e,t,n,r,i){return" dimmed"},6:function(e,t,n,r,i){return"	"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["photo-well-scrappy-edit-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},8:function(e,t,n,r,i){return"	"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["fave-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},10:function(e,t,n,r,i){return"disabled"},12:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'		<a href="'+a((s=(s=n.downloadLink||(t!=null?t.downloadLink:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"downloadLink",hash:{},data:i}):s))+'" class="server-only-link" title="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_VIDEO"},data:i}))+'">\n'},14:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'		<a href="'+a((s=(s=n.downloadLink||(t!=null?t.downloadLink:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"downloadLink",hash:{},data:i}):s))+'" title="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_PHOTO"},data:i}))+'">\n'},16:function(e,t,n,r,i){return'		<div class="display-obscured-download-sizes">\n			'+e.escapeExpression((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||n.helperMissing).call(t!=null?t:{},t!=null?t.downloadItems:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"\n		</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{};return((s=n["if"].call(o,t!=null?t.showLicenseButton:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.canCreateWallart:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.viewerIsOwner:t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.program(8,i,0),data:i}))!=null?s:"")+"\n"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(o,t!=null?t["share-view"]:t,{name:"outlet",hash:{},data:i}))+'\n\n<div class="download '+((s=n.unless.call(o,t!=null?t.downloadingAvailable:t,{name:"unless",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(o,t!=null?t.isVideo:t,{name:"if",hash:{},fn:e.program(12,i,0),inverse:e.program(14,i,0),data:i}))!=null?s:"")+'			<i class="ui-icon-download"></i>\n		</a>\n\n'+((s=n["if"].call(o,t!=null?t.downloadItems:t,{name:"if",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-engagement",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-download-dialog",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'			"'+e.escapeExpression(e.lambda((s=t!=null?t.photo:t)!=null?s.title:s,t))+'"\n'},3:function(e,t,n,r,i){var s;return'            <i class="ui-icon-tiny-'+e.escapeExpression(e.lambda((s=t!=null?t.photo:t)!=null?s.license:s,t))+'cc"></i>\n'},5:function(e,t,n,r,i){return'            <i class="ui-icon-tiny-government"></i>\n'},7:function(e,t,n,r,i){return'            <i class="ui-icon-tiny-noKnown"></i>\n'},9:function(e,t,n,r,i){return'			<i class="ui-icon-tiny-copyright">&nbsp;</i>\n'},11:function(e,t,n,r,i){var s,o=e.escapeExpression;return'		    <span class="license license-'+o(e.lambda((s=t!=null?t.photo:t)!=null?s.license:s,t))+'">'+o((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:i}))+"</span>\n"},13:function(e,t,n,r,i){var s,o=e.escapeExpression;return'		    <span class="license license-'+o(e.lambda((s=t!=null?t.photo:t)!=null?s.license:s,t))+'">'+o((n.licenseString||t&&t.licenseString||n.helperMissing).call(t!=null?t:{},(s=t!=null?t.photo:t)!=null?s.license:s,{name:"licenseString",hash:{},data:i}))+"</span>\n"},15:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'			<li class="'+l((o=(o=n.label||(t!=null?t.label:t))!=null?o:a,typeof o===f?o.call(u,{name:"label",hash:{},data:i}):o))+((s=n["if"].call(u,t!=null?t.selected:t,{name:"if",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				<a href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" data-track="downloadSizeSelected'+l((o=(o=n.label||(t!=null?t.label:t))!=null?o:a,typeof o===f?o.call(u,{name:"label",hash:{},data:i}):o))+'">\n					<span class="label">'+l((o=(o=n.label||(t!=null?t.label:t))!=null?o:a,typeof o===f?o.call(u,{name:"label",hash:{},data:i}):o))+'</span>\n					<span class="resolution">'+l((o=(o=n.width||(t!=null?t.width:t))!=null?o:a,typeof o===f?o.call(u,{name:"width",hash:{},data:i}):o))+" &times; "+l((o=(o=n.height||(t!=null?t.height:t))!=null?o:a,typeof o===f?o.call(u,{name:"height",hash:{},data:i}):o))+"</span>\n				</a>\n			</li>\n"},16:function(e,t,n,r,i){return" selected"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression,f=e.lambda;return'<div class="download-dialog">\n	<h2>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD_PHOTO"},data:i}))+'</h2>\n	<p class="title">\n'+((s=n["if"].call(o,(s=t!=null?t.photo:t)!=null?s.title:s,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"		by "+a(f((s=(s=t!=null?t.photo:t)!=null?s.owner:s)!=null?s.displayname:s,t))+'\n	</p>\n	<p class="license-info">\n	<a href="'+a((n.configVal||t&&t.configVal||u).call(o,"licenseUrls",(s=t!=null?t.photo:t)!=null?s.license:s,{name:"configVal",hash:{},data:i}))+'" class="license-url" target="_newtab">\n'+((s=n["if"].call(o,t!=null?t.licenseIsCreativeCommons:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.licenseisGovt:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.licenseisNoLic:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.licenseisCopy:t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.licenseIsCreativeCommons:t,{name:"if",hash:{},fn:e.program(11,i,0),inverse:e.program(13,i,0),data:i}))!=null?s:"")+'	</a>\n    </p>\n	<ul class="sizes">\n'+((s=n.each.call(o,t!=null?t.sizes:t,{name:"each",hash:{},fn:e.program(15,i,0),inverse:e.noop,data:i}))!=null?s:"")+"	</ul>\n	<p class='buttons'>\n		<a href=\""+a(f((s=t!=null?t.photo:t)!=null?s.url:s,t))+'/sizes/l" class="all-sizes" data-track="viewAllSizesClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.VIEW_ALL_SIZES"},data:i}))+'</a>\n		<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-done" data-track="downloadClick"><span>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.DOWNLOAD"},data:i}))+'</span></button>\n	</p>\n	<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-close hide-text"><span>&nbsp;</span></button>\n</div>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/download-dialog",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-scrappy-download-menu",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.sizes:t,{name:"each",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:""},2:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		    <li class="'+f((s=(s=n.label||(t!=null?t.label:t))!=null?s:u,typeof s===a?s.call(o,{name:"label",hash:{},data:i}):s))+'">\n			    <a href="'+f((s=(s=n.url||(t!=null?t.url:t))!=null?s:u,typeof s===a?s.call(o,{name:"url",hash:{},data:i}):s))+'" data-track="downloadSizeSelected'+f((s=(s=n.label||(t!=null?t.label:t))!=null?s:u,typeof s===a?s.call(o,{name:"label",hash:{},data:i}):s))+'" class="download-image-size">\n				    <span class="label">'+f((s=(s=n.label||(t!=null?t.label:t))!=null?s:u,typeof s===a?s.call(o,{name:"label",hash:{},data:i}):s))+'</span>\n				    <span class="resolution">('+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+" &times; "+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+")</span>\n			    </a>\n		    </li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=e.escapeExpression;return'<ul class="sizes">\n'+((s=n["if"].call(o,t!=null?t.showDownloadSizes:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'	<li><a href="'+u(e.lambda((s=t!=null?t.photo:t)!=null?s.url:s,t))+'/sizes/l" class="all-sizes server-only-link" data-track="viewAllSizesClick">'+u((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.VIEW_ALL_SIZES"},data:i}))+"</a></li>\n</ul>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/scrappy-download-menu",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("wallart-helper",function(e){"use strict";e.WallartHelper=function(e){this.validWallartTypes=["canvas","mounted"],this.appContext=e,this.dimensions=[{canvas:{FLICKR_2_1:[975,825,750,600,693,543,28.5,28.5,112.5,112.5,75,75,93.75],FLICKR_2_3:[1125,1125,900,900,1050,1050,75,75,150,150,75,75,125],FLICKR_2_2:[1275,1050,1050,825,1250,950,75,75,150,150,75,75,125],FLICKR_2_4:[1725,1425,1500,1200,1850,1450,75,75,150,150,75,75,125],FLICKR_2_5:[2025,1725,1800,1500,2250,1850,75,75,150,150,75,75,125],FLICKR_2_6:[2475,1725,2250,1500,2850,1850,75,75,150,150,75,75,125]},mounted:{FLICKR_2_9:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_1:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_2:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_3:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_11:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_1:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_2:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_3:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_1:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_2:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_3:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_1:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_2:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_3:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_1:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_2:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_3:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100,100]}},{canvas:{FLICKR_2_1:[825,975,600,750,543,693,28.5,28.5,112.5,112.5,75,75,93.75],FLICKR_2_3:[1125,1125,900,900,1050,1050,75,75,150,150,75,75,125],FLICKR_2_2:[1050,1275,825,1050,950,1250,75,75,150,150,75,75,125],FLICKR_2_4:[1425,1725,1200,1500,1450,1850,75,75,150,150,75,75,125],FLICKR_2_5:[1725,2025,1500,1800,1850,2250,75,75,150,150,75,75,125],FLICKR_2_6:[1725,2475,1500,2250,1850,2850,75,75,150,150,75,75,125]},mounted:{FLICKR_2_9:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_1:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_2:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_9_3:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100,100],FLICKR_2_11:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_1:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_2:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_11_3:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_1:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_2:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_10_3:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_1:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_2:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_12_3:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_1:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_2:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100,100],FLICKR_2_13_3:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100,100]}}]},e.WallartHelper.prototype.getNewSku=function(e,t){var n,r,i=e.slice(e.length-1);if(t.size){["FLICKR_2_1","FLICKR_2_3","FLICKR_2_2","FLICKR_2_4","FLICKR_2_5","FLICKR_2_6"].indexOf(e)>-1?r="canvas":["FLICKR_2_9","FLICKR_2_11","FLICKR_2_10","FLICKR_2_12","FLICKR_2_13"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_1","FLICKR_2_11_1","FLICKR_2_10_1","FLICKR_2_12_1","FLICKR_2_13_1"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_2","FLICKR_2_11_2","FLICKR_2_10_2","FLICKR_2_12_2","FLICKR_2_13_2"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_3","FLICKR_2_11_3","FLICKR_2_10_3","FLICKR_2_12_3","FLICKR_2_13_3"].indexOf(e)>-1&&(r="mounted");switch(t.size){case"8x10":case"10x8":r==="canvas"?n="FLICKR_2_1":r==="mounted"&&(n="FLICKR_2_9",this.convertSkuTo(e,"type")==="mounted"?["1","2","3"].indexOf(i)>-1?n+="_"+i:n+="_1":n+="_1");break;case"12x12":r==="canvas"?n="FLICKR_2_3":r==="mounted"&&(n="FLICKR_2_11",this.convertSkuTo(e,"type")==="mounted"?["1","2","3"].indexOf(i)>-1?n+="_"+i:n+="_1":n+="_1");break;case"11x14":case"14x11":r==="canvas"?n="FLICKR_2_2":r==="mounted"&&(n="FLICKR_2_10",this.convertSkuTo
(e,"type")==="mounted"?["1","2","3"].indexOf(i)>-1?n+="_"+i:n+="_1":n+="_1");break;case"16x20":case"20x16":r==="canvas"?n="FLICKR_2_4":r==="mounted"&&(n="FLICKR_2_12",this.convertSkuTo(e,"type")==="mounted"?["1","2","3"].indexOf(i)>-1?n+="_"+i:n+="_1":n+="_1");break;case"20x24":case"24x20":r==="canvas"&&(n="FLICKR_2_5");break;case"20x30":case"30x20":r==="canvas"?n="FLICKR_2_6":r==="mounted"&&(n="FLICKR_2_13",this.convertSkuTo(e,"type")==="mounted"?["1","2","3"].indexOf(i)>-1?n+="_"+i:n+="_1":n+="_1")}}if(t.style)switch(t.style){case"canvas":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_1";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_3";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_2";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_4";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_6";break;case"mounted":e==="FLICKR_2_1"?n="FLICKR_2_9_1":e==="FLICKR_2_3"?n="FLICKR_2_11_1":e==="FLICKR_2_2"?n="FLICKR_2_10_1":e==="FLICKR_2_4"?n="FLICKR_2_12_1":e==="FLICKR_2_5"?n="FLICKR_2_12_1":e==="FLICKR_2_6"&&(n="FLICKR_2_13_1")}if(t.material)switch(t.material){case"lustre":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_1";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_1";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_1";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_1";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_1";break;case"glossy":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_2";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_2";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_2";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_2";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_2";break;case"matte":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_3";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_3";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_3";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_3";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_3"}return n},e.WallartHelper.prototype.getArtDimensions=function(e,t){var n={renderedWidth:0,renderedHeight:1,shownWidth:2,shownHeight:3,guarenteedWidth:4,guarenteeHeight:5,safetyWidth:6,safetyHeight:7,bleedWidth:8,bleedHeight:9,optimumDPI:10,minimumDPI:11,depth:12},r,i=[];r=this.dimensions;switch(e){case"FLICKR_2_1":i=r[t].canvas.FLICKR_2_1;break;case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":i=r[t].mounted.FLICKR_2_9;break;case"FLICKR_2_3":i=r[t].canvas.FLICKR_2_3;break;case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":i=r[t].mounted.FLICKR_2_11;break;case"FLICKR_2_2":i=r[t].canvas.FLICKR_2_2;break;case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":i=r[t].mounted.FLICKR_2_10;break;case"FLICKR_2_4":i=r[t].canvas.FLICKR_2_4;break;case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":i=r[t].mounted.FLICKR_2_12;break;case"FLICKR_2_5":i=r[t].canvas.FLICKR_2_5;break;case"FLICKR_2_6":i=r[t].canvas.FLICKR_2_6;break;case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":i=r[t].mounted.FLICKR_2_13}return{map:n,dimensions:i}},e.WallartHelper.prototype.isCC=function(e){return e.getValue("photoSource")===2?!0:!1},e.WallartHelper.prototype.isMK=function(e){return e.getValue("photoSource")===3?!0:!1},e.WallartHelper.prototype.getCorrectedLargestSize=function(e){var t,n,r;return e.getValue("oWidth")&&e.getValue("oHeight")?t={width:e.getValue("oWidth"),height:e.getValue("oHeight")}:t=e.getLargestSize({excludeSizes:[]}),r={width:t.width,height:t.height},n=e.getValue("rotation"),Math.abs(n)%180!==0&&(t.width=r.height,t.height=r.width),t},e.WallartHelper.prototype.getInitialSku=function(e,t){var n,r,i=["FLICKR_2_4","FLICKR_2_12_1","FLICKR_2_12_2","FLICKR_2_12_3"],s;return this.wallartModel=e,e.getValue("photo").getValue("oWidth")&&e.getValue("photo").getValue("oHeight")?s={width:e.getValue("photo").getValue("oWidth"),height:e.getValue("photo").getValue("oHeight")}:s=this.getCorrectedLargestSize(e.getValue("photo")),s.width>=s.height?r=0:r=1,e.setValue("isCC",this.isCC(e)),e.setValue("isMK",this.isMK(e)),n=this.getLargestSizeWallartSku(s,r,t,i),t==="mounted"&&n.match(/(FLICKR_)[0-9]{1,2}_[0-9]{1,2}_[0-9]{1,2}/g)&&(n=n.slice(0,-1)+"1"),{sku:n,orientation:r}},e.WallartHelper.prototype.getLargestSizeWallartSku=function(e,t,n,r){var i,s,o,u=!1;s=this.dimensions,r||(r=[]);for(o in s[t][n]){if(e.width>=s[t][n][o][0]&&e.height>=s[t][n][o][1]){i=o;if(r.indexOf(o)>-1)break;continue}if(!i){u=!0;break}break}if(u){u=!1;for(o in s[t].canvas){if(!(e.width>=s[t].canvas[o][0]&&e.height>=s[t].canvas[o][1])){i||(i=o);break}i=o}}return i},e.WallartHelper.prototype.convertSkuTo=function(e,t,n,r){var i;n||(n=0),r||(r=!1);if(t==="size")switch(e){case"FLICKR_2_1":case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":n===0?i="8x10":n===1&&(i="10x8");break;case"FLICKR_2_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":i="12x12";break;case"FLICKR_2_2":case"FLICKR_2_10"
:case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":n===0?i="11x14":n===1&&(i="14x11");break;case"FLICKR_2_4":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":n===0?i="16x20":n===1&&(i="20x16");break;case"FLICKR_2_5":n===0?i="20x24":n===1&&(i="24x20");break;case"FLICKR_2_6":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":n===0?i="20x30":n===1&&(i="30x20")}else if(t==="size-copy")switch(e){case"FLICKR_2_1":case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":n===0?i='8" x 10"':n===1&&(i='10" x 8"');break;case"FLICKR_2_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":i='12" x 12"';break;case"FLICKR_2_2":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":n===0?i='11" x 14"':n===1&&(i='14" x 11"');break;case"FLICKR_2_4":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":n===0?i='16" x 20"':n===1&&(i='20" x 16"');break;case"FLICKR_2_5":n===0?i='20" x 24"':n===1&&(i='24" x 20"');break;case"FLICKR_2_6":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":n===0?i='20" x 30"':n===1&&(i='30" x 20"')}else if(t==="type")switch(e){case"FLICKR_2_1":case"FLICKR_2_3":case"FLICKR_2_2":case"FLICKR_2_4":case"FLICKR_2_5":case"FLICKR_2_6":i="canvas";break;case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":i="mounted"}else if(t==="product-description")switch(e){case"FLICKR_2_1":i={title:"wallart.CANVAS_WRAP",description:["","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_8X10":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_10X8"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_3":i={title:"wallart.CANVAS_WRAP",description:["wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_12X12","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_2":i={title:"wallart.CANVAS_WRAP",description:["","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_11X14":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_14X11"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_4":i={title:"wallart.CANVAS_WRAP",description:["","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_16X20":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_20X16"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_5":i={title:"wallart.CANVAS_WRAP",description:["","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_20X24":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_24X20"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_6":i={title:"wallart.CANVAS_WRAP",description:["","wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_20X30":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_1_30X20"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW");break;case"FLICKR_2_9":case"FLICKR_2_9_1":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND_PREVIEW");break;case"FLICKR_2_9_2":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND_PREVIEW");break;case"FLICKR_2_9_3":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND_PREVIEW");break;case"FLICKR_2_10":case"FLICKR_2_10_1":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND_PREVIEW");break;case"FLICKR_2_10_2":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND_PREVIEW");break;case"FLICKR_2_10_3":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND_PREVIEW"
);break;case"FLICKR_2_11":case"FLICKR_2_11_1":i={title:"wallart.PHOTO_MOUNT",description:["wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE"]};break;case"FLICKR_2_11_2":i={title:"wallart.PHOTO_MOUNT",description:["wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY"]},r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW");break;case"FLICKR_2_11_3":i={title:"wallart.PHOTO_MOUNT",description:["wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE"]},r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW");break;case"FLICKR_2_12":case"FLICKR_2_12_1":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_PREVIEW");break;case"FLICKR_2_12_2":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW");break;case"FLICKR_2_12_3":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW");break;case"FLICKR_2_13":case"FLICKR_2_13_1":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_PREVIEW");break;case"FLICKR_2_13_2":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW");break;case"FLICKR_2_13_3":i={title:"wallart.PHOTO_MOUNT",description:["","wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE"]},n===0?i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30":n===1&&(i.description[0]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20"),r&&(i.description[1]="wallart.PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW")}else if(t==="material")switch(e){case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_13":case"FLICKR_2_13_1":i="lustre";break;case"FLICKR_2_9_2":case"FLICKR_2_11_2":case"FLICKR_2_10_2":case"FLICKR_2_12_2":case"FLICKR_2_13_2":i="glossy";break;case"FLICKR_2_9_3":case"FLICKR_2_11_3":case"FLICKR_2_10_3":case"FLICKR_2_12_3":case"FLICKR_2_13_3":i="matte"}else if(t==="material-pretty")switch(e){case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_13":case"FLICKR_2_13_1":i="wallart.PREMIUM_LUSTRE";break;case"FLICKR_2_9_2":case"FLICKR_2_11_2":case"FLICKR_2_10_2":case"FLICKR_2_12_2":case"FLICKR_2_13_2":i="wallart.GLOSSY";break;case"FLICKR_2_9_3":case"FLICKR_2_11_3":case"FLICKR_2_10_3":case"FLICKR_2_12_3":case"FLICKR_2_13_3":i="wallart.MATTE"}return i},e.WallartHelper.prototype.isValidWallartType=function(e){return typeof e=="string"&&this.validWallartTypes.indexOf(e)>-1},e.WallartHelper.prototype.getCreationsThumbInfo=function(e,t){var n,r,i,s,o,u;return n=this.convertSkuTo(e,"type",t),i=this.convertSkuTo(e,"size",t),s=this.convertSkuTo(e,"size-copy",t),r=this.convertSkuTo(e,"product-description",t),i==="12x12"?o="square":o=t===0?"landscape":"portrait",r||(r={title:""}),u={type:n,size:i,sizeCopy:s,typeCopy:r.title,layout:o},u},e.WallartHelper.prototype.isPhotoWallartable=function(e,t){var n,r=[],i=[],s=[],o=[],u,a,f=[];u=this.getCorrectedLargestSize(e),t||(u.width>=u.height?t=0:t=1);for(a in this.dimensions[t].canvas)u.width>=this.dimensions[t].canvas[a][0]&&u.height>=this.dimensions[t].canvas[a][1]&&f.indexOf(a)<0&&(r.push(a),i.push(this.convertSkuTo(a,"size",t)),s.push("canvas"),o.push("canvas"+this.convertSkuTo(a,"size",t)));for(a in this.dimensions[t].mounted)u.width>=this.dimensions[t].mounted[a][0]&&u.height>=this.dimensions[t].mounted[a][1]&&f.indexOf(a)<0&&(r.push(a),i.push(this.convertSkuTo(a,"size",t)),s.push("mounted"),o.push("mounted"+this.convertSkuTo(a,"size",t)));return n={skus:r,sizes:i,types:s,typeAndSize:o},n}},"@VERSION@",{affinity:"",requires:[],optional:[]});
YUI.add("fluid-share-photo-view",function(e,t){e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.constructor.superclass.initializer.call(this,e)},loadState:function(){var t=this;return e.Promise.all([this.appContext.getModel("photo-models",this.photoId),this.appContext.getModel("photo-privacy-models",this.photoId),this.appContext.getModel("photo-engagement-models",this.photoId),this.appContext.getModel("photo-tags-models",this.photoId)]).then(function(e){return t.set("photoModel",e[0]),t.set("privacyModel",e[1]),t.set("engagementModel",e[2]),t.set("photoTagsModels",e[3]),t.set("tags",t.get("photoTagsModels").getValue("tags").toJSON()),t.get("photoModel").canVr().then(function(e){t.set("canVr",e)})})},buildContainer:function(){var e=this.get("photoModel").getValue("safetyLevel")===2;return this.get("photoModel").getValue("owner").id!==this.appContext.getViewer().nsid&&(e=e||!this.get("privacyModel").getValue("isPublic")),this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-photo-icon",showShareButtonLabel:!1,sharingDisabled:e,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_PHOTO"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("photoModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("photoModel");return{url:e.URLHelper.getShortURL(t.getValue("id")),title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"})}},prepareTumblrShareParameters:function(){var e=this.get("photoModel"),t=e.getValue("owner"),n=e.getLargestSize({excludeSizes:["o"]}).displayUrl,r=this.appContext.flipper.isFlipped("enable-flickr-embeds-on-tumblr");return{title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),authorURL:t.getValue("url"),ownerName:t.getValue("displayname"),description:e.getValue("description"),displayPhotoURL:r?e.getValue("url"):n,url:e.getValue("url"),isPhotoPage:!0,tags:this.get("tags").map(function(e){return e.tagRaw}).join(",")}},preparePinterestShareParameters:function(){var t=this.get("photoModel");return{title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),description:t.getValue("description"),displayPhotoURL:t.getLargestSize({excludeSizes:["o"]}).displayUrl,shortURL:e.URLHelper.getShortURL(t.getValue("id")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("photoModel");return{title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),modelName:"photo",modelId:e.getValue("id"),url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t=this.get("photoModel"),n=this.get("engagementModel").getValue("canShare"),r;return n&&this.get("photoModel").getValue("isVideo")&&this.appContext.flipper.isFlipped("enable-embedr-video")?r=!0:r=n&&!this.get("photoModel").getValue("isVideo"),{url:this.appContext.flipper.isFlipped("enable-embedr-in-share")?e.config.win.location.pathname:t.getValue("url"),author:t.getValue("owner").getValue("displayname"),authorURL:t.getValue("owner").getValue("url"),shortURL:e.URLHelper.getShortURL(t.getValue("id")),supportsEmbedr:r,supportsBBCode:n,sizes:t.getValue("sizes"),title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),secret:t.getValue("secret"),privacyWarningString:this.intlMessage({intlName:"share-modal.PHOTO_PAGE_PRIVACY_WARNING"}),aspectRatio:t.getValue("aspectRatio")}},getTitleIntlKey:function(){var e=this.get("photoModel");return e.getValue("isVideo")?"SHARE_VIDEO_TO":"SHARE_PHOTOS_TO"},getGuestPassParams:function(){var e=this.get("privacyModel"),t=e.getValue("isVisibleByFriends"),n=e.getValue("isVisibleByFamily"),r=!e.getValue("isPublic"),i=this.get("photoModel"),s=i.getValue("isOwner"),o;return n&t?o=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_FRIENDS_MESSAGE"}):n?o=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_MESSAGE"}):t?o=this.intlMessage({intlName:"share-modal.PHOTO_FRIENDS_MESSAGE"}):r&&(o=this.intlMessage({intlName:"share-modal.PHOTO_PRIVATE_MESSAGE"})),{type:"photo",id:this.photoId,contentMarkedFriends:s&&t&&!n,contentMarkedFamily:s&&n&&!t,contentMarkedFriendFamily:s&&n&&t,contentMarkedPublic:!r&&!n&&!t,canSharePrivate:s&&r&&!n&&!t,showGuestPassDropdown:s&&r,multipleItems:!1,sharingEntirelyNotPublic:s&&r,nonPublicWarning:o}},getIsMine:function(){return this.get("photoModel").getValue("isOwner")},getSignedOutSharingPerms:function(){var e=this.get("engagementModel").getValue("canShare");return{facebook:{canShare:e},twitter:{canShare:e},tumblr:{canShare:e},pinterest:{canShare:e},flickr:{canShare:!1}}},onParentViewEvent:function(e,t){(t[0]==="enable-sharing"||t[0]==="disable-sharing")&&this.buildContainer()},shouldCancelModal:function(){var e=this.get("photoModel").getValue("safetyLevel")===2;return e&&this.buildContainer(),e}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper","flutil"],langBundles:["models","default","share-modal"]});
YUI.add("hermes-lang-default",function(e,t){e.Intl.add("hermes/default","en-US",{UNTITLED:["Untitled"]})},"@VERSION@",{requires:["intl"]});
YUI.add("basic-book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{title:{},owner:{},coverPhoto:{isModel:!0},coverPhotoDeleted:{defaultFn:function(){return!1}},cropW:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropH:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropX:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropY:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},totalPages:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater"]});
YUI.add("flickr-creations-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=t[9],p=[],d=[],v=[];return r&&r.stat==="ok"&&(p=Object.keys(r.wallart_ids).map(function(e){return r.wallart_ids[e]}),e.Array.each(p,function(t,n){if(t.photoSource===2)return;var r,i,s,u=[],p=!1,v,m,g,y={};r=a.addOrUpdate({id:t.owner}),t.photo.id?(y={photos:[t.photo],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c,photoCurationModelRegistry:h},t.photo.ownerId&&(y.ownerID=t.photo.ownerId),i=e.APIHelper.response.parsePhotos(y)[0]):p=!0,t.orders&&typeof t.orders=="object"&&(s=Object.keys(t.orders).map(function(e){return t.orders[e]}),e.Array.each(s,function(e){u.push({orderId:e.orderId,orderStatus:e.order.statusOrder,dateCreate:e.dateCreate,dateUpdate:e.dateUpdate})})),t.skuId.substr(-2)==="CC"?(v=t.skuId.slice(0,-3),m=!0):t.skuId.substr(-2)==="MK"?(v=t.skuId.slice(0,-3),g=!0):v=t.skuId,d.push(o.addOrUpdate({id:t.wallartId,owner:r,photo:i,photoDeleted:p,skuId:v,isCC:m,isMK:g,orientation:t.orientation,price:t.price,cropW:t.photo.cropW,cropH:t.photo.cropH,cropX:t.photo.cropX,cropY:t.photo.cropY,isEditable:t.isEditable,isLowQuality:t.isLowQuality,created:t.dateCreate,updated:t.dateUpdate,orders:u,photoSource:t.photoSource}))})),i&&i.stat==="ok"&&e.Array.each(i.books.book,function(t,n){var r=!1,i,s;i=a.addOrUpdate({id:t.owner}),t.coverPhoto.id?s=e.APIHelper.response.parsePhotos({photos:[t.coverPhoto],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c})[0]:r=!0,v.push(u.addOrUpdate({id:t.id,title:t.title,owner:i,coverPhoto:s,coverPhotoDeleted:r,totalPages:t.countPages,created:t.dateCreate,updated:t.dateUpdate,cropW:t.coverPhoto.cropW/100,cropH:t.coverPhoto.cropH/100,cropX:t.coverPhoto.cropX/100,cropY:t.coverPhoto.cropY/100}))}),s.addOrUpdate({id:n.id,wallarts:d,books:v}),{wallarts:d,books:v}}function i(n,r){var i=this,s=this._processParams(n);return e.Promise.all([r.callAPI("flickr.products.wallart.getList",s,!0),r.callAPI("flickr.products.books.getList",s,!0),r.getModelRegistry("creations-models"),r.getModelRegistry("wallart-models"),r.getModelRegistry("basic-book-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-creations"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["creations-models","wallart-models","basic-book-models","person-models","photo-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("creations-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-creations"].run(t,this.appContext)}},removeCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").remove(e)}),n.books&&e.Array.each(n.books,function(e,n){r.getValue(t,"books").remove(e)})},appendCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").unshift(e)})},attributes:{wallarts:{isCollection:!0},books:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-promise","model-proxy","flickr-model-registry","flickr-creations-fetcher"],optional:["wallart-models","basic-book-models"]});
YUI.add("flickr-products-wallart-create-creator",function(e,t){"use strict";function r(e){var t={};return e=e||{},t.photo_id=e.photoId,t.sku_id=e.skuId,t}function i(e,t,r){var i=e[0],s=e[1],o=e[2],u=e[3],a=t.nsid,f,l,c,h,p=!1,d=!1,v=e[4],m,g;return i?(f=i.wallart,c=o.exists(a)?o.proxy(a):o.add({id:a}),l=u.exists(t.photoId)?u.proxy(t.photoId):u.add({id:t.photoId}),f.skuId.substr(-2)==="CC"?(h=f.skuId.slice(0,-3),p=!0):f.skuId.substr(-2)==="MK"?(h=f.skuId.slice(0,-3),d=!0):h=f.skuId,s.exists(f.wallartId)?(s.setValues(f.wallartId,{owner:c,photo:l,skuId:h,isCC:p,isMK:d,orientation:f.orientation,photoSource:f.photoSource}),g=s.proxy(f.wallartId)):g=s.add({id:f.wallartId,owner:c,photo:l,skuId:h,isCC:p,isMK:d,orientation:f.orientation,created:f.dateCreate,photoSource:f.photoSource}),v.exists(a)&&(m=v.proxy(a),m.appendCreations({wallarts:[s.proxy(f.wallartId)]}))):(n.warn("No API response?"),g=this),g}function s(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.create",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("creations-models")]).then(function(e){return i._processResponse(e,n,r)},e.FetcherErrorLogger(t))}var n=require("lib/flog")(t);e.namespace("ModelCreators")["flickr-products-wallart-create"]={run:s,_processParams:r,_processResponse:i}},"@VERSION@",{requires:["flickr-promise","wallart-models"],optional:["person-models","photo-models","creations-models"]});
YUI.add("flickr-products-wallart-editWallart-updater",function(e,t){"use strict";function n(e,t,n){var r=e.response,i=e.wallartModelRegistry;i.exists(t)&&i.setValue(t,"price",r.wallart.price);if(this.pendingUpdate)return this.pendingUpdate=!1,this.startNextUpdate(t,n)}function r(e,t){return t.getModel("wallart-models",e).then(function(e){var t,n,r,i,s;return n=e.getValue("photo"),i=e.getValue("isCC"),s=e.getValue("isMK"),r=e.getValue("skuId"),i===!0?r+="_CC":s===!0&&(r+="_MK"),t={wallart_id:e.id,photo:{id:n.getValue("id"),owner:n.getValue("owner").getValue("id"),crop_x:e.getValue("cropX"),crop_y:e.getValue("cropY"),crop_h:e.getValue("cropH"),crop_w:e.getValue("cropW")},sku_id:r,orientation:e.getValue("orientation"),is_low_quality:e.getValue("isLowQuality")},{wallart:JSON.stringify(t)}})}function i(n,r){var i=this;return this.serialize(n,r).then(function(s){return(new e.FlickrPromise({response:r.callAPI("flickr.products.wallart.update",s),wallartModelRegistry:r.getModelRegistry("wallart-models")})).then(function(e){return i.processResponse(e,n,r)},function(e){throw i.pendingUpdate&&(i.pendingUpdate=!1),e}).then(null,e.FetcherErrorLogger(t))})}function s(){return this.updateInFlight=null,!0}function o(e,t){return this.updateInFlight=this.callAPI(e,t).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight}function u(e,t){return this.pendingUpdate=null,this.startUpdate(e,t)}function a(e,t){return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(e,t)}e.namespace("ModelUpdaters")["flickr-products-wallart-editWallart"]={run:a,serialize:r,callAPI:i,clearUpdateInFlight:s,startUpdate:o,processResponse:n,startNextUpdate:u}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("wallart-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-wallart"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-products-wallart-create"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-wallart-editWallart"].run(t,this.appContext)}},attributes:{owner:{isModel:!0},photo:{isModel:!0},photoDeleted:{defaultFn:function(){return!1}},isCC:{defaultFn:function(){return!1}},isMK:{defaultFn:function(){return!1}},photoSource:{},skuId:{},orientation:{},price:{},cropW:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropH:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropX:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropY:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},isLowQuality:{defaultFn:function(){return 0}},isEditable:{defaultFn:function(){return!0}},isDeleted:{defaultFn:function(){return!1}},invalidForPrintReason:{},isInvalidForPrint:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}},orders:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-wallart-fetcher","flickr-products-wallart-create-creator","flickr-products-wallart-editWallart-updater"]});
YUI.add("flickr-products-wallart-fetcher",function(e,t){"use strict";function n(t){var n={wallart_id:t.id,return_deleted:1,extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=r.wallart,c,h,p,d,v=!1,m=!1,g={};if(l)return p=s.addOrUpdate({id:l.owner}),g={photos:[l.photo],personModelRegistry:s,photoModelRegistry:o,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f},l.photo.ownerId&&(g.ownerID=l.photo.ownerId),h=e.APIHelper.response.parsePhotos(g)[0],l.skuId.substr(-2)==="CC"?(d=l.skuId.slice(0,-3),v=!0):l.skuId.substr(-2)==="MK"?(d=l.skuId.slice(0,-3),m=!0):d=l.skuId,c={id:l.wallartId,owner:p,photo:h,skuId:d,isCC:v,isMK:m,orientation:l.orientation,price:l.price,cropW:l.photo.cropW,cropH:l.photo.cropH,cropX:l.photo.cropX,cropY:l.photo.cropY,isEditable:l.isEditable,isDeleted:l.isDeleted,isLowQuality:l.isLowQuality,photoSource:l.photoSource,created:l.dateCreate},i.addOrUpdate(c),c}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.getDetails",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-products-wallart"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["wallart-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("photo-engagement-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.signinPendingQueue=e.signinPendingQueue,this},subviewConfig:{"fave-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,hideWhoFaved:!0},"photo-well-scrappy-edit-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-share-photo-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e=this.get("photo"),t=e.getValue("owner"),n=e.getValue("isMarketplaceLicensable")&&this.appContext.flipper.getValue("licensing-button-placement")==="toolbar",r;return r={"share-view":this.subviews["fluid-share-photo-view"]?this.subviews["fluid-share-photo-view"].get("container"):"",photoId:e.getValue("id"),ownerId:e.getValue("owner").getValue("id"),isVideo:e.getValue("isVideo"),viewerIsOwner:t.getValue("isMe"),canCreateWallart:this.canCreateWallart(),isWallartLowQuality:this.isWallartLowQuality(),downloadingAvailable:!1,downloadLink:"",showLicenseButton:n,marketplaceLicensingUrl:e.getValue("marketplaceLicensingUrl")},e.getValue("isVideo")?(r.downloadLink="/video_download.gne?id="+e.getValue("id"),this.appContext.flipper.isFlipped("enable-album-download")&&(r.downloadingAvailable=e.getValue("engagement").getValue("canDownload")),t.getValue("isMe")&&(r.downloadingAvailable=!0)):(r.downloadLink=e.getValue("url")+"/sizes/l/",r.downloadingAvailable=!0),this.appContext.forceServerRender&&(r.downloadItems=this.getDownloadMenuItems()),this.setContainerWithTemplate("photo-engagement",r),r.canCreateWallart&&this.get("container").addClass("has-wallart"),n&&this.get("container").addClass("has-buyable"),this},buildErrorContainer:function(){this.setContainerHTML("")},activate:function(){var e=this.get("photo").getValue("license"),t=e!==0&&e!==7&&e!==8&&e!==10,n=e===8,r=e===9,i=e===10,s=this.get("container");if(this.signinPendingQueue&&this.signinPendingQueue.length>0){var o=this.signinPendingQueue;for(var u=0;u<o.length;u++)o[u].key==="download"&&o[u].value&&o[u].value.id===this.photoId&&this.downloadItem(o[u].value.imageUrl)}return this.appContext.flipper.isFlipped("enable-signed-out-download-cta-test")&&!this.appContext.getViewer().signedIn&&!this.appContext.getUA().isBot&&this.get("photo").getValue("owner").getValue("isPro")!==!0&&!t&&!n&&!r&&!i&&this.get("photo").getValue("visibilitySource")!==2&&(this.signedOutTest=!0),this.createDownloadDialog(this.getDownloadMenuItems()),this.registerEventHandler(s.all(".sizes li a.download-image-size").on("click",this.handleDownloadItemClick,this)),this.attachKeyEvent("down:68",this.handleDownloadMenuButtonClick.bind(this)),this.registerEventHandler(s.delegate("click",this.handleDownloadMenuButtonClick.bind(this),".download a")),this.registerEventHandler(s.delegate("click",this.createWallartClick.bind(this),".wallart a")),this.registerEventHandler(this.get("photo").on("valuesChanged",function(e){e.isMarketplacePrintable&&e.isMarketplacePrintable.newVal===!0&&(this.buildContainer(),this.getDownloadMenuItems(),this.get("container").all(".sizes li a.download-image-size").on("click",this.handleDownloadItemClick,this))}.bind(this))),this.signedOutTest&&this.registerEventHandler(s.one(".all-sizes").on("click",function(e){e.halt(),this.signUpAndDownloadItem()}.bind(this))),this.appContext.flipper.isFlipped("display-marketplace-licensable")&&s.one(".photoListLicenseButton")&&(this.registerEventHandler(s.one(".photoListLicenseButton").on("click",this.licenseButtonClick,this)),this.registerEventHandler(s.one(".photoListLicenseButton").on("mouseenter",this.licenseButtonHover,this)),this.registerEventHandler(s.one(".photoListLicenseButton").on("mouseleave",this.licenseButtonHover,this))),this},licenseButtonHover:function(t){var n=300;t.halt();var r=t.type,i=this;if(r==="mouseenter"){if(e.StorageHelper.getItem("seenThirdParty"))return;this.tooltip&&this.tooltip.close(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!0,this.tooltipHoverTimer=setTimeout(function(){i.isHovering&&(i.tooltip=new e.Views.FluidDroparound({appContext:i.appContext,showDropArrow:!0,dismissOnOverlayClick:!1,dismissOnActionClick:!1,observePageResize:!0,anchorElement:t.target,positionFixed:!0,closeOnScroll:!0,hideModalOverlay:!0,invisibleOverlay:!0,autoSizeToContent:!0,useAnchorOffsetSize:!0,horizCenterToAnchor:!0,preferTop:!0,classList:"photo-license-pop-up",textMessage:i.intlMessage({intlName:"common.CLICK_BUTTON_THIRD_PARTY"})}),i.tooltip.show())},n)}else this.isHovering=!1,this.tooltip&&this.tooltip.close()},licenseButtonClick:function(t){var r={owner_id:t.target.getData("ownerid"),photo_id:t.target.getData("photoid")};this.appContext.callAPI("flickr.licensing.marketplace.addClick",r).then(function(){e.StorageHelper.setItem("seenThirdParty",1)},function(e){n.error("flickr.licensing.marketplace.addClick failed",{photoId:r.photo_id})})},canCreateWallart:function(){var e=!1,t,n=this.appContext.getViewer(),r,i,s,o,u;return t=this.get("photo"),t&&n&&(i=!1,r=t.getValue("owner").getValue("isMe"),s=t.getValue("isMarketplacePrintable"),u=t.getValue("safetyLevel")===0,o=!t.getValue("isVideo"),this.appContext.flipper.isFlipped("creative-commons-wallart")?r?this.appContext.getViewer().signedIn&&o&&(e=!0):i?this.appContext.getViewer().signedIn&&o&&u&&(e=!0):s&&this.appContext.getViewer().signedIn&&o&&u&&(e=!0):this.appContext.getViewer().signedIn&&r&&o&&(e=!0)),e},isWallartLowQuality:function(){var t=this.get("photo");return this.wallartHelper||(this.wallartHelper=new e.WallartHelper),this.wallartHelper.isPhotoWallartable(t).skus.length===0?!0:!1},createWallartClick:function(n){var r=this,i="/create/wallart/",s=this.get("photo"),o;n.halt(),e.rapidTracker
.beacon(t,"createWallartClick");if(s.getValue("hasInvalidColorspaceForPrint"))return this.handleLacksWallartability("COLORSPACE");this.wallartHelper||(this.wallartHelper=new e.WallartHelper(this.appContext));if(this.wallartHelper.isPhotoWallartable(s).skus.length===0)return this.handleLacksWallartability("LOW_QUALITY");this.appContext.getModelRegistry("wallart-models").then(function(t){t.remoteCreate({nsid:r.appContext.getViewer().nsid,photoId:s.getValue("id")}).then(function(t){i+=t.getValue("id")+"/edit",YUI.Env.isServer||(!r.appContext.secure&&window.location.host===e.config.flickr.url.host?e.config.win.location.href=i:r.appContext.flapp.navigate(i))},function(t){o=new e.Views.FluidModal({appContext:r.appContext,darkOverlay:!0,dismissOnOverlayClick:!0,actionButtonLabel:r.intlMessage({intlName:"common.OK"}),title:r.intlMessage({intlName:"common.UPLOAD_ERROR_TITLE"}),message:"There was a problem creating your wall art. Please try again later."}),o.show()})})},handleLacksWallartability:function(t){var n,r;t==="LOW_QUALITY"?r="Looks like this photo doesn't meet the minimum requirements to get printed. Please choose a photo that's at least 975 &times; 825 pixels. Learn more about <a href='http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567'>requirements</a> for print products.":t==="COLORSPACE"&&(r="Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href='https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33'>Learn more</a>."),n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,showCancelX:!0,title:"Try a different photo",message:r,classList:"lacks-wallartability"}),n.show()},getDownloadMenuItems:function(t){var n=e.clone(this.get("photo").toJSON()),r,i=[],s,o=this.get("photo").getValue("engagement").getValue("canDownload"),u=!1;if(!n||!n.sizes)return"";n.sizes.q&&(n.sizes.q.label=this.intlMessage({intlName:"photo-page-scrappy.SQUARE"}),i.push(n.sizes.q)),n.sizes.s&&(n.sizes.s.label=this.intlMessage({intlName:"photo-page-scrappy.SMALL"}),i.push(n.sizes.s)),n.sizes.z&&(n.sizes.z.label=this.intlMessage({intlName:"photo-page-scrappy.MEDIUM"}),i.push(n.sizes.z)),n.sizes.k?(n.sizes.k.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.k)):n.sizes.h?(n.sizes.h.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.h)):n.sizes.l&&(n.sizes.l.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.l)),n.sizes.o&&(n.sizes.o.label=this.intlMessage({intlName:"photo-page-scrappy.ORIGINAL"}),i.push(n.sizes.o));for(s=0;s<i.length;s++)i[s].url=i[s].displayUrl.replace(/^(.+)(\..+)$/,"$1_d$2");return o&&(u=!0),r=this.templates("scrappy-download-menu")({photo:n,sizes:i,showDownloadSizes:u}),r},createDownloadDialog:function(t){var n=this.get("container"),r=this;this.downloadMenu=e.Views.dialog.getNewInstance("dialog-tooltip",{content:t,anchorTo:n.one(".download"),dropUp:!0,parent:this,positioning:!1,rootEl:n}),this.downloadMenu.render(),this.downloadMenu.on("toggle",function(e){e&&e.details&&e.details.length>0&&(e.details[0]?r.fire("subviewViewEvent","make in view",n):r.fire("subviewViewEvent","close in view"))})},handleDownloadMenuButtonClick:function(n){var r=this.get("photo"),i;if(n.target.ancestor(".download",!0).hasClass("disabled"))n.preventDefault();else if(r.getValue("isVideo"))if(!this.appContext.flipper.isFlipped("enable-album-download")){i=r.getValue("owner").getValue("isMe");if(!i)return n.preventDefault(),!1}else this.handleDownloadItemClick(n);else n.halt(),this.downloadMenu.toggle();e.rapidTracker.beacon(t,"downloadDialogClick")},handleDownloadItemClick:function(n){n.preventDefault();var r;r=n.currentTarget.getAttribute("href"),this.signedOutTest?this.signUpAndDownloadItem(r):this.downloadItem(r),e.rapidTracker.beacon(t,"photoDownloadClick"),this.downloadMenu.hide()},downloadItem:function(e){document.location=e},signUpAndDownloadItem:function(t){var n=this,r=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_TITLE"}),i=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_MESSAGE"}),s,o;this.get("photo").getValue("isVideo")&&this.appContext.lang.toLowerCase()==="en-us"&&(r=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_VIDEO_TITLE"})),s=e.url(e.URLHelper.getPhotoPage({photoId:this.photoId,pathAlias:this.nsid})),o=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-download",signUpTitle:r,signUpMessage:i,beaconPrefix:"download"}),o.on("signUpClick",function(r){t?e.SigninHelper.signUpPendingDownload({id:n.photoId,imageUrl:t},{postLoginUrl:s}):e.SigninHelper._redirectToSignUp("download",{postLoginUrl:s+"sizes/l/"})}),o.on("signInClick",function(r){t?e.SigninHelper.addPendingDownload({id:n.photoId,imageUrl:t},{postLoginUrl:s}):e.SigninHelper._redirectToSignin("download",{postLoginUrl:s+"sizes/l/"})}),o.show()}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-engagement","hermes-template-download-dialog","hermes-template-scrappy-download-menu","wallart-helper","photo-engagement-css","signup-modal-view","fluid-share-photo-view","fluid-droparound-view","better-throttle"],optional:["photo-models","wallart-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("seo",function(e,t){e.Seo={appContext:{},getSEOTitleForPhoto:function(e,t,n,r){var i=e.getValue("og:title"),s=e.getValue("og:description"),o="",u="| Flickr",a=70,f=a-(i.length+u.length+5);return i==="Untitled"&&(i=r),i.length>50?o=i.slice(0,58)+(i.length<58?" ":"\u2026 "):i.length>20&&i.length<50?s.length>20?o=i+" | "+s.slice(0,f)+(s.length<f?" ":"\u2026 "):o=i+" | "+s.slice(0,f)+(s.length<f?" ":"\u2026 ")+"| "+n+" ":i.length<=20&&(s.length>50?o=i+" | "+s.slice(0,f)+(s.length<f?" ":"\u2026 "):o=i+" | "+s.slice(0,f)+(s.length<f?" ":"\u2026 ")+"| "+n+" "),o},generateSEODescriptionForPhoto:function(e,t,n,r,i){var s=e.getValue("og:title"),o=e.getValue("og:description"),u="",a=160;return s==="Untitled"&&(s=r),o.length>120?u=o.slice(0,120)+(o.length<120?" ":"\u2026 ")+n+" "+i+".":o.length>60&&o.length<120?u=o+(o.slice(o.length-1,o.length)==="."?" ":". ")+s.slice(0,40)+(s.length<40?" ":"\u2026 ")+n+" "+i+".":o.length<=60&&(u=s+(s.slice(s.length-1,s.length)==="."?" ":". ")+o.slice(0,a-s.length)+(o.length<a-s.length?" ":"\u2026 ")+n+" "+i+"."),u}}},"@VERSION@",{requires:[]});
